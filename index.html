<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>🎁 Shutterized Hongbao DApp</title>
  <script src="https://cdn.jsdelivr.net/npm/web3/dist/web3.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <h1 class="title">🎁 Shutterized Hongbao Gifting DApp</h1>

    <!-- Sender Section -->
    <div id="sender-section" class="section hidden">
      <h2>Gong Xi Fa Cai! 恭喜发财 🎉</h2>

      <p>Send a time-locked Hangbao to fellow crypto and not-yet crypto friends and admirers. Secure, private, and unlocked whenever you want.</p>
      <div class="hongbao-envelope">
        <label for="hongbao-amount">💰 Amount (XDAI):</label>
        <input type="number" id="hongbao-amount" class="input" step="0.01" placeholder="Enter amount">
        
        <label for="unlock-time">⏰ Select Unlock Time:</label>
      <select id="unlock-time" class="input">
        <option value="60">1 minute from now</option>
        <option value="300">5 minutes from now</option>
        <option value="1800">30 minutes from now</option>
        <option value="lunar-new-year">Lunar New Year (Jan 29, 2025, 12:36 UTC)</option>
        <option value="custom">Custom</option>
      </select>

      <div id="custom-timestamp-container" class="hidden">
        <label for="custom-timestamp">Enter Custom Date/Time:</label>
        <input type="datetime-local" id="custom-timestamp" class="input">
      </div>


        <label for="hongbao-password">🔒 Password (optional):</label>
        <input type="password" id="hongbao-password" class="input" placeholder="Enter a password to protect the Hongbao">
        
        <button id="create-hongbao" class="button">Create Hongbao with MetaMask</button>
        <button id="create-hongbao-with-passkey" class="button">Fund Hongbao with Passkey Wallet</button>
        
        <p>Note, the receiver doesn't need any funds, nor a wallet to claim</p>
        <p id="hongbao-details" class="details hidden"></p>
        <p id="hongbao-link" class="link hidden"></p>
        <div id="hongbao-visual" class="hongbao-visual hidden"></div>
      </div>
    </div>

    <!-- Receiver Section -->
    <div id="receiver-section" class="section hidden">
      <h2>Gong Xi Fa Cai! 恭喜发财 🎉</h2>
      <p class="details">
        Someone gifted you a Hongbao with some xDAI on Gnosis Chain! This Hongbao is locked until Lunar New Year! It was encrypted with Shutter, and will unlock exactly on time thanks to encryption and decryption magic!
        <br>
        <a href="https://www.shutter.network/" target="_blank" rel="noopener noreferrer" class="shutter-link">
          Curious how it works? Learn more about Shutter’s threshold encryption here!
        </a>
      </p>

      <div class="hongbao-envelope">
<label for="hongbao-key" class="secondary-label">🔑 Encrypted Key:</label>
<input type="text" id="hongbao-key" class="input secondary-input" placeholder="Paste encrypted key from link">

<label for="hongbao-timestamp" class="secondary-label">⏰ Timestamp:</label>
<input type="text" id="hongbao-timestamp" class="input secondary-input" placeholder="Paste timestamp from link">

        
        <div id="password-container" class="hidden">
          <label for="redeem-password">🔑 Password (if protected):</label>
          <input type="password" id="redeem-password" class="input" placeholder="Enter the password">
          <button id="decrypt-password" class="button">Decrypt with Password</button>
        </div>
        
        
        
        <h3>Countdown to Unlock:</h3>
        <p id="countdown" class="countdown"></p>
        

        <div id="redemption-options">
          <button id="redeem-new-wallet" class="button hidden">Claim to a New Wallet</button>
          <button id="toggle-other-options" class="button small hidden">Other Claiming Options</button>
          <div id="other-claim-options" class="hidden">
            <button id="redeem-existing-wallet" class="button">Claim to an Existing Wallet</button>
            <button id="redeem-hongbao" class="button">Redeem to MetaMask</button>
          </div>
        </div>
        
        
        <p id="redemption-details" class="details hidden"></p>
        <p id="redeem-result" class="details hidden"></p>
        <div id="hongbao-visual-redeem" class="hongbao-visual hidden"></div>
      </div>
      
      <div id="create-own-section">
        <button id="create-own-hongbao" class="button">Create Your Own Hongbao</button>
      </div>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/ethers/dist/ethers.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
  <script type="module" src="app.js"></script>
</body>
</html>
